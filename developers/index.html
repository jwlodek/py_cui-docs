<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>For PyCUI Developers - py_cui Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "For PyCUI Developers";
    var mkdocs_page_input_path = "developers.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> py_cui Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../install/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Using and Writing PyCUIs</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../usage/">Basic Usage</a>
                </li>
                <li class="">
                    
    <a class="" href="../widgets/">Widgets</a>
                </li>
                <li class="">
                    
    <a class="" href="../colors/">Colors</a>
                </li>
                <li class="">
                    
    <a class="" href="../popups/">Popups</a>
                </li>
                <li class="">
                    
    <a class="" href="../keybindings/">Keys</a>
                </li>
                <li class="">
                    
    <a class="" href="../writing/">Writing a PyCUI step-by-step</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Classes / Functions</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../DocstringGenerated/PyCUI.md">PyCUI</a>
                </li>
                <li class="">
                    
    <a class="" href="../DocstringGenerated/Grid/">Grid</a>
                </li>
                <li class="">
                    
    <a class="" href="../DocstringGenerated/Widgets/">Widgets</a>
                </li>
                <li class="">
                    
    <a class="" href="../DocstringGenerated/Popups/">Popups</a>
                </li>
                <li class="">
                    
    <a class="" href="../DocstringGenerated/Colors/">Colors</a>
                </li>
                <li class="">
                    
    <a class="" href="../DocstringGenerated/WidgetSet/">Widget Sets</a>
                </li>
                <li class="">
                    
    <a class="" href="../DocstringGenerated/Renderer/">Renderer</a>
                </li>
                <li class="">
                    
    <a class="" href="../DocstringGenerated/Keys/">Keys</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">For PyCUI Developers</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#documentation-for-py_cui-developers">Documentation for py_cui Developers</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#adding-a-new-widget">Adding a new Widget</a></li>
        
            <li><a class="toctree-l3" href="#adding-a-new-popup">Adding a new Popup</a></li>
        
            <li><a class="toctree-l3" href="#working-on-the-renderer">Working on the renderer</a></li>
        
            <li><a class="toctree-l3" href="#working-on-color-rules">Working on color rules</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../examples/">Examples</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../about/">About</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">py_cui Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>For PyCUI Developers</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/jwlodek/py_cui/edit/master/docs/developers.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="documentation-for-py_cui-developers">Documentation for py_cui Developers</h1>
<p>This page contains information on writing new widgets and popups, as well as anything else required for developers and contributors for py_cui.</p>
<h3 id="adding-a-new-widget">Adding a new Widget</h3>
<p>We will walk through the steps of adding a new widget to py_cui (in this case a scroll menu) in order to demonstrate this process.</p>
<p><strong>Step One - Extend the Widget Class</strong></p>
<p>Your first step when writing a new widget is to create a class in <code>py_cui/widgets.py</code> that extends the base <code>Widget</code> class. For our <code>ScrollMenu</code> example:</p>
<pre><code class="Python">class ScrollMenu(Widget):

    def __init__(self, id, title, grid, row, column, row_span, column_span, padx, pady):
        super().__init__(id, title, grid, row, column, row_span, column_span, padx, pady)

    def handle_key_press(self, key_pressed):

        super().handle_key_press(key_pressed)

    def draw(self):

        super().draw()
</code></pre>

<p>The <code>handle_key_press</code> and <code>draw</code> functions must be extended for your new widget. You may leave the <code>handle_key_press</code> as above, if you don't require any keybindings for the widget. The <code>draw</code> function must extended, as the base class does no drawing itself, instead just setting up color rules.</p>
<p><strong>Step Two - Add additional class variables</strong></p>
<p>Next, add any variables that your widget may require on top of the base <code>Widget</code> class variables. In our case, it will be the selected item index, a list of menu items, and an integer representing the top item visible (in case the menu scrolls down). We also add some functions for getting and setting these variables.</p>
<pre><code class="Python">def __init__(self, id, title, grid, row, column, row_span, column_span, padx, pady):
    super().__init__(id, title, grid, row, column, row_span, column_span, padx, pady)
    self.top_view = 0
    self.selected_item = 0
    self.view_items = []


def clear(self):
    &quot;&quot;&quot; Clears all items from the Scroll Menu &quot;&quot;&quot;

    self.view_items = []
    self.selected_item = 0
    self.top_view = 0


def add_item_list(self, item_list):

    for item in item_list:
        self.add_item(item)


def remove_selected_item(self):

    if len(self.view_items) == 0:
        return
    del self.view_items[self.selected_item]
    if self.selected_item &gt;= len(self.view_items):
        self.selected_item = self.selected_item - 1


def get_item_list(self):

    return self.view_items


def get(self):

    if len(self.view_items) &gt; 0:
        return self.view_items[self.selected_item]
    return None
</code></pre>

<p><strong>Step 3 - Add Key Bindings</strong></p>
<p>Next, add any default key bindings you wish to have for the widget when in focus mode. In the case of the scroll menu, we wish for the arrow keys to scroll up and down, so we extend the <code>handle_key_press</code> function:</p>
<pre><code class="Python">def scroll_up(self):

    if self.selected:
        if self.top_view &gt; 0:
            self.top_view = self.top_view - 1
        if self.selected_item &gt; 0:
            self.selected_item = self.selected_item - 1


def scroll_down(self):

    if self.selected:
        if self.selected_item &lt; len(self.view_items) - 1:
            self.selected_item = self.selected_item + 1
        if self.selected_item &gt; self.top_view + self.height - (2 * self.pady) - 3:
            self.top_view = self.top_view + 1


def handle_key_press(self, key_pressed):

    super().handle_key_press(key_pressed)
    if key_pressed == py_cui.keys.KEY_UP_ARROW:
        self.scroll_up()
    if key_pressed == py_cui.keys.KEY_DOWN_ARROW:
        self.scroll_down()
</code></pre>

<p>Note that the way default key bindings are added are simply <code>if</code> statements, which happen after the <code>super()</code> call. The <code>scroll_up()</code> and <code>scroll_down()</code> functions simply contain the logic for editing the viewport for the menu.</p>
<p><strong>Step 4 - implement the Draw function</strong></p>
<p>In the draw function, you must use the <code>self.renderer</code> object to render your widget to the screen. In our case, we want a border around the menu widget, and we also want to draw menu items that are within our viewport. The key renderer functions we will use are:</p>
<pre><code class="Python">self.renderer.draw_border(self)
</code></pre>

<p>which will draw a border around the widget space, and </p>
<pre><code class="Python">self.renderer.draw_text(self, text, y_position)
</code></pre>

<p>which will draw the text in the y_position. For our scroll menu, we would write the following:</p>
<pre><code class="Python">def draw(self):

    super().draw()
    # sets the color mode
    self.renderer.set_color_mode(self.color)
    # draws border around widget
    self.renderer.draw_border(self)
    # will store the current y-position
    counter = self.pady + 1
    line_counter = 0
    for line in self.view_items:
        # Until we reach viewport start, increment counter
        if line_counter &lt; self.top_view:
            line_counter = line_counter + 1
        else:
            if counter &gt;= self.height - self.pady - 1:
                break
            if line_counter == self.selected_item:
                self.renderer.draw_text(self, line, self.start_y + counter, selected=True)
            else:
                self.renderer.draw_text(self, line, self.start_y + counter)
            counter = counter + 1
            line_counter = line_counter + 1
    # reset default colors
    self.renderer.unset_color_mode(self.color)
    # reset cursor should be called at the end of every draw function
    self.renderer.reset_cursor(self)
</code></pre>

<p><strong>Step 5 - add a function to <code>__init__.py</code> to add the widget</strong></p>
<p>Finally, add a function to <code>__init__.py</code> that will add the widget to the CUI. In our case we write the following:</p>
<pre><code class="Python">def add_scroll_menu(self, title, row, column, row_span = 1, column_span = 1, padx = 1, pady = 0):

    id = 'Widget{}'.format(len(self.widgets.keys()))
    new_scroll_menu = widgets.ScrollMenu(id, title, self.grid, row, column, row_span, column_span, padx, pady)
    self.widgets[id] = new_scroll_menu
    if self.selected_widget is None:
        self.set_selected_widget(id)
    return new_scroll_menu
</code></pre>

<p>The function must:
* Create an id titled 'Widget####' where #### is replaced with the number of widget
* Add the widget to the PyCUI widgets dict with the ID as a key
* If there is no selected widget, make this new widget the selected one
* Return a reference to the widget</p>
<p><strong>That's it!</strong></p>
<p>Your widget is now ready to be added to the CUI!</p>
<h3 id="adding-a-new-popup">Adding a new Popup</h3>
<p>This documentation section is incomplete. Feel free to <a href="https://github.com/jwlodek/py_cui/pulls">expand me</a>.</p>
<h3 id="working-on-the-renderer">Working on the renderer</h3>
<p>This documentation section is incomplete. Feel free to <a href="https://github.com/jwlodek/py_cui/pulls">expand me</a>.</p>
<h3 id="working-on-color-rules">Working on color rules</h3>
<p>This documentation section is incomplete. Feel free to <a href="https://github.com/jwlodek/py_cui/pulls">expand me</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../examples/" class="btn btn-neutral float-right" title="Examples">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../DocstringGenerated/Keys/" class="btn btn-neutral" title="Keys"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>2019 - Jakub Wlodek</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/jwlodek/py_cui/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../DocstringGenerated/Keys/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../examples/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
